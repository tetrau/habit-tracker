(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,a){e.exports=a(28)},20:function(e,t,a){},28:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(13),s=a.n(r),c=(a(20),a(1)),o=a.n(c),l=a(3),h=a(2),u=a(4),d=a(5),b=a(7),m=a(6),p=a(8),v=(a(22),a(23),a(14)),f=a(10),g=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(b.a)(this,Object(m.a)(t).call(this,e))).incOne=a.incOne.bind(Object(h.a)(a)),a.clickHandler=a.clickHandler.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"timestamp",value:function(){return(new Date).getTime()/1e3}},{key:"incOne",value:function(){var e=Object(l.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.habit,void 0===t.journal[this.props.dateString]?t.journal[this.props.dateString]={goal:this.props.habit.goal,activity:[this.timestamp()]}:t.journal[this.props.dateString].activity.push(this.timestamp()),e.next=5,this.props.modifiyHabit(t);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"clickHandler",value:function(e){var t=e.currentTarget.getBoundingClientRect();e.clientX<(t.left+t.right)/2?this.props.changeMode({habitId:this.props.habit.id,mode:"config"}):this.incOne()}},{key:"activity",value:function(){var e=this.props.habit.journal[this.props.dateString];return void 0===e?[]:e.activity}},{key:"goal",value:function(){var e=this.props.habit.journal[this.props.dateString];return void 0===e?this.props.habit.goal:e.goal}},{key:"render",value:function(){var e=Math.min(100,Math.ceil(this.activity().length/this.goal()*100)),t={width:e.toString()+"%"};return i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-12"},i.a.createElement("div",{className:"card mb-2",onClick:this.clickHandler},i.a.createElement("div",{className:"card-body"},i.a.createElement("h5",{className:"mb-0"},this.props.habit.name),i.a.createElement("div",{className:"progress"},i.a.createElement("div",{className:100===e?"progress-bar bg-success":"progress-bar",role:"progressbar",style:t},this.activity().length.toString()+"/"+this.goal().toString()))))))}}]),t}(i.a.Component),k=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(b.a)(this,Object(m.a)(t).call(this,e))).state={name:void 0!==a.props.presetName?a.props.presetName:"",goal:void 0!==a.props.presetGoal?a.props.presetGoal:"",nameValid:!0,goalValid:!0},a.clickSave=a.clickSave.bind(Object(h.a)(a)),a.handleGoalChange=a.handleGoalChange.bind(Object(h.a)(a)),a.handleNameChange=a.handleNameChange.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"handleNameChange",value:function(e){this.setState({name:e.target.value})}},{key:"handleGoalChange",value:function(e){this.setState({goal:e.target.value})}},{key:"clickSave",value:function(){var e=Object(l.a)(o.a.mark(function e(){var t,a,n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setState({nameValid:!0,goalValid:!0}),0!==(t=this.state.name).length&&"string"===typeof t){e.next=5;break}return this.setState({nameValid:!1}),e.abrupt("return");case 5:if(a=Number(this.state.goal),Number.isInteger(a)&&!(a<=0)){e.next=9;break}return this.setState({goalValid:!1}),e.abrupt("return");case 9:n={name:t,goal:a},this.props.setHabit(n);case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e="form-control"+(this.state.nameValid?"":" is-invalid"),t="form-control"+(this.state.goalValid?"":" is-invalid");return i.a.createElement("div",{className:"form-row"},i.a.createElement("div",{className:"col-12"},i.a.createElement("label",{htmlFor:"habit-name",className:"mb-0"},"Name"),i.a.createElement("input",{id:"habit-name",className:e,onChange:this.handleNameChange,value:this.state.name}),!this.state.nameValid&&i.a.createElement("div",{className:"invalid-feedback"},"Please provide a valid name."),i.a.createElement("label",{htmlFor:"habit-goal",className:"mb-0"},"Goal"),i.a.createElement("input",{id:"habit-goal",className:t,min:"0",type:"number",onChange:this.handleGoalChange,value:this.state.goal}),!this.state.goalValid&&i.a.createElement("div",{className:"invalid-feedback"},"Please provide a valid goal (positive integer)."),i.a.createElement("div",{className:"d-flex flex-row-reverse pt-2"},i.a.createElement("button",{className:"btn btn-primary",onClick:this.clickSave},"Save"),this.props.displayDelete&&i.a.createElement("button",{className:"btn btn-danger mr-2",onClick:this.props.deleteHabit},"Delete Habit"))))}}]),t}(n.Component),y=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(b.a)(this,Object(m.a)(t).call(this,e))).setHabit=a.setHabit.bind(Object(h.a)(a)),a.clickUndo=a.clickUndo.bind(Object(h.a)(a)),a.deleteHabit=a.deleteHabit.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"setHabit",value:function(){var e=Object(l.a)(o.a.mark(function e(t){var a,n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.props.habit,n=a.journal[this.props.dateString],a.name=t.name,a.goal=t.goal,void 0!==n&&(n.goal=t.goal),e.next=7,this.props.modifiyHabit(a);case 7:this.props.changeMode({mode:"normal"});case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"deleteHabit",value:function(){var e=Object(l.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.habit.id,!window.confirm("Confirm Delete habit -"+this.props.habit.name+"- ?")){e.next=5;break}return e.next=5,this.props.deleteHabit(t);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"clickUndo",value:function(){var e=Object(l.a)(o.a.mark(function e(){var t,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.habit,a=this.props.dateString,void 0!==t.journal[a]&&0!==t.journal[a].activity.length){e.next=6;break}return e.abrupt("return");case 6:return t.journal[a].activity.pop(),e.next=9,this.props.modifiyHabit(t);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.habit.journal[this.props.dateString];return e=void 0===e?[]:e.activity,i.a.createElement(i.a.Fragment,null,i.a.createElement(k,{presetName:this.props.habit.name,presetGoal:this.props.habit.goal.toString(),setHabit:this.setHabit,deleteHabit:this.deleteHabit,displayDelete:!0}),e.length>0&&i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"row mt-2"},i.a.createElement("div",{className:"col-12"},i.a.createElement("ul",{className:"list-group"},e.map(function(e,t){return i.a.createElement("li",{className:"list-group-item",key:t},new Date(1e3*e).toLocaleString())})))),i.a.createElement("div",{className:"row mt-2"},i.a.createElement("div",{className:"col-12"},i.a.createElement("div",{className:"d-flex flex-row-reverse"},i.a.createElement("button",{className:"btn btn-primary",onClick:this.clickUndo},"Undo Last Activity"))))))}}]),t}(n.Component),j=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(b.a)(this,Object(m.a)(t).call(this,e))).createHabit=a.createHabit.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"uuidv4",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}},{key:"createHabit",value:function(){var e=Object(l.a)(o.a.mark(function e(t){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={goal:t.goal,journal:{},name:t.name,id:this.uuidv4()},e.next=3,this.props.createHabit(a);case 3:this.props.changeMode({mode:"normal"});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return i.a.createElement(k,{setHabit:this.createHabit})}}]),t}(n.Component),x=function(e){function t(e){var a;Object(u.a)(this,t),(a=Object(b.a)(this,Object(m.a)(t).call(this,e))).clearDatabase=a.clearDatabase.bind(Object(h.a)(a));var n=[];for(var i in a.props.habits)n.push(a.props.habits[i]);return n=JSON.stringify(n,null,2),n=new Blob([n],{type:"application/json"}),a.exportHabitsURL=URL.createObjectURL(n),a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"clearDatabase",value:function(){var e=Object(l.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Confirm delete the database content?")){e.next=5;break}return e.next=4,this.props.database.clear("habits");case 4:this.props.clearHabit();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){URL.revokeObjectURL(this.exportHabitsURL)}},{key:"render",value:function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"btn btn-outline-danger btn-lg btn-block",onClick:this.clearDatabase},"Clear Database"))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col"},i.a.createElement("a",{className:"btn btn-outline-primary btn-lg btn-block mt-2",download:"habit.json",href:this.exportHabitsURL},"Export to Json"))))}}]),t}(n.Component),O=function(e){function t(){return Object(u.a)(this,t),Object(b.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"navbar navbar-light bg-light mb-2"},i.a.createElement("div",{className:"container d-flex justify-content-between"},i.a.createElement("a",{className:"btn btn-outline-link btn-sm",onClick:this.props.clickLeft},"<"),i.a.createElement("a",{className:"navbar-brand",onClick:this.props.gotoToday},this.props.dateString),i.a.createElement("a",{className:"btn btn-outline-link btn-sm",onClick:this.props.clickRight,style:{visibility:this.props.hideRight?"hidden":"visible"}},">")))}}]),t}(i.a.Component),E=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(b.a)(this,Object(m.a)(t).call(this,e))).state={habits:{},date:new Date,mode:{mode:"normal"}},a.dateString=a.dateString.bind(Object(h.a)(a)),a.dateToDateString=a.dateToDateString.bind(Object(h.a)(a)),a.modifiyHabit=a.modifiyHabit.bind(Object(h.a)(a)),a.changeMode=a.changeMode.bind(Object(h.a)(a)),a.createHabit=a.createHabit.bind(Object(h.a)(a)),a.deleteHabit=a.deleteHabit.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(d.a)(t,[{key:"dateToDateString",value:function(e){return e.getFullYear().toString().padStart(4,"0")+"-"+(e.getMonth()+1).toString().padStart(2,"0")+"-"+e.getDate().toString().padStart(2,"0")}},{key:"dateString",value:function(){return this.dateToDateString(this.state.date)}},{key:"changeMode",value:function(e){this.setState({mode:e})}},{key:"modifiyHabit",value:function(){var e=Object(l.a)(o.a.mark(function e(t){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.database.put("habits",t);case 2:(a=this.state.habits)[t.id]=t,this.setState({habits:a});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"deleteHabit",value:function(){var e=Object(l.a)(o.a.mark(function e(t){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.database.delete("habits",t);case 2:delete(a=this.state.habits)[t],this.setState({habits:a,mode:{mode:"normal"}});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createHabit",value:function(){var e=Object(l.a)(o.a.mark(function e(t){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.database.add("habits",t);case 2:(a=this.state.habits)[t.id]=t,this.setState({habits:a});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(l.a)(o.a.mark(function e(){var t,a,n,i,r,s,c;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.a)("habitTracker",1,{upgrade:function(e,t,a,n){console.log("create database"),e.createObjectStore("habits",{keyPath:"id"})}});case 2:return t=e.sent,this.database=t,e.next=6,t.count("habits");case 6:if(0!==e.sent){e.next=20;break}return a=[],n=this.database.transaction("habits","readwrite"),i=n.objectStore("habits"),e.next=13,Promise.all(a.map(function(e){return i.add(e)}));case 13:return e.next=15,n.done;case 15:r={},a.forEach(function(e){return r[e.id]=e}),this.setState({habits:r}),e.next=26;break;case 20:return e.next=22,this.database.getAll("habits");case 22:s=e.sent,c={},s.forEach(function(e){return c[e.id]=e}),this.setState({habits:c});case 26:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,a=this,n=[];for(var r in this.state.habits){var s=i.a.createElement(g,{habit:this.state.habits[r],dateString:this.dateString(),key:r,modifiyHabit:this.modifiyHabit,changeMode:this.changeMode});n.push(s)}var c=i.a.createElement(O,{clickLeft:function(){var e=a.state.date;e.setDate(a.state.date.getDate()-1),a.setState({date:e})},clickRight:function(){var e=a.state.date;e.setDate(a.state.date.getDate()+1),a.setState({date:e})},hideRight:!1,dateString:this.dateString(),gotoToday:function(){return a.setState({date:new Date})}}),o=i.a.createElement(O,{clickLeft:function(){return a.changeMode({mode:"normal"})},clickRight:function(){},hideRight:!0,dateString:this.dateString(),gotoToday:function(){return a.setState({date:new Date})}});return"normal"===this.state.mode.mode?(e=i.a.createElement(i.a.Fragment,null,n,i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-6 pr-1"},i.a.createElement("div",{className:"btn btn-outline-primary btn-lg btn-block",onClick:function(){return a.changeMode({mode:"appConfig"})}},i.a.createElement(f.c,{icon:f.a,size:"medium"}))),i.a.createElement("div",{className:"col-6 pl-1"},i.a.createElement("div",{className:"btn btn-outline-primary btn-lg btn-block",onClick:function(){return a.changeMode({mode:"create"})}},i.a.createElement(f.c,{icon:f.b,size:"medium"}))))),t=c):"config"===this.state.mode.mode?(e=i.a.createElement(y,{habit:this.state.habits[this.state.mode.habitId],dateString:this.dateString(),modifiyHabit:this.modifiyHabit,changeMode:this.changeMode,deleteHabit:this.deleteHabit}),t=o):"create"===this.state.mode.mode?(e=i.a.createElement(j,{changeMode:this.changeMode,createHabit:this.createHabit}),t=o):"appConfig"===this.state.mode.mode&&(e=i.a.createElement(x,{clearHabit:function(){a.setState({mode:{mode:"normal"},habits:{}})},database:this.database,habits:this.state.habits}),t=o),i.a.createElement("div",{className:"container"},t,e)}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(E,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[15,1,2]]]);
//# sourceMappingURL=main.d25976ae.chunk.js.map